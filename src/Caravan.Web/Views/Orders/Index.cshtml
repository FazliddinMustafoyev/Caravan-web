@using Caravan.Service.ViewModels;
@model PagedList<OrderViewModel>

<div class="row g-10" style="display: flex; justify-content: center">
    @{
        foreach (var order in Model)
        {
            <div class="col-lg-4 card min-h-300px mt-15 me-5 mx-5" style="padding-left: 0; width: 300px">
                <a asp-controller="orders" asp-action="get" asp-route-orderId="@order.Id">
                    <div class="image-center w-300px h-250px" style="display: flex; justify-content: center">
                        <img src="~/@order.ImagePath" class="card-rounded mw-100 min-w-100 min-h-100 mh-sm-100" />
                    </div>
                </a>
                <div class="mb-5 mt-5 ms-3">
                    <div class="mt-2 text-center">
                        <span class="fs-2 fw-bold text-black-800">@order.Name</span>
                    </div>
                    <div class="ms-3">
                        @if (order.IsTaken)
                        {
                            <span class="badge badge-primary">Empty</span>
                        }
                        else
                        {
                            <span class="badge badge-danger">Busy</span>
                        }
                    </div>
                    <div class="ms-3">
                        <span class="fs-5 fw-normal text-gray-600">@order.User.FirstName</span>
                    </div>
                    <div class="ms-3">
                        <span class="fs-5 fw-normal text-gray-600">@order.Price so'm</span>
                    </div>
                    <div class="d-flex flex-row justify-content-between ms-2">
                        <div class="row-cols-2 text-sm-end">
                            <span class="svg-icon svg-icon-primary svg-icon-2x">
                                <!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-05-14-112058/theme/html/demo1/dist/../src/media/svg/icons/Devices/iPhone-X.svg-->
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <rect x="0" y="0" width="24" height="24" />
                                        <path d="M8,2.5 C7.30964406,2.5 6.75,3.05964406 6.75,3.75 L6.75,20.25 C6.75,20.9403559 7.30964406,21.5 8,21.5 L16,21.5 C16.6903559,21.5 17.25,20.9403559 17.25,20.25 L17.25,3.75 C17.25,3.05964406 16.6903559,2.5 16,2.5 L8,2.5 Z" fill="#000000" opacity="0.3" />
                                        <path d="M8,2.5 C7.30964406,2.5 6.75,3.05964406 6.75,3.75 L6.75,20.25 C6.75,20.9403559 7.30964406,21.5 8,21.5 L16,21.5 C16.6903559,21.5 17.25,20.9403559 17.25,20.25 L17.25,3.75 C17.25,3.05964406 16.6903559,2.5 16,2.5 L8,2.5 Z M8,1 L16,1 C17.5187831,1 18.75,2.23121694 18.75,3.75 L18.75,20.25 C18.75,21.7687831 17.5187831,23 16,23 L8,23 C6.48121694,23 5.25,21.7687831 5.25,20.25 L5.25,3.75 C5.25,2.23121694 6.48121694,1 8,1 Z M9.5,1.75 L14.5,1.75 C14.7761424,1.75 15,1.97385763 15,2.25 L15,3.25 C15,3.52614237 14.7761424,3.75 14.5,3.75 L9.5,3.75 C9.22385763,3.75 9,3.52614237 9,3.25 L9,2.25 C9,1.97385763 9.22385763,1.75 9.5,1.75 Z" fill="#000000" fill-rule="nonzero" />
                                    </g>
                                </svg><!--end::Svg Icon-->
                            </span>
                            <span class="fs-5 fw-normal text-gray-600">@order.User.PhoneNumber</span>
                        </div>
                        
                        <div class="row-cols-2 text-sm-end">
                            <span class="svg-icon svg-icon-primary svg-icon-2x">
                                <!--begin::Svg Icon | path:/var/www/preview.keenthemes.com/metronic/releases/2021-05-14-112058/theme/html/demo1/dist/../src/media/svg/icons/Map/Marker2.svg-->
                                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="24px" height="24px" viewBox="0 0 24 24" version="1.1">
                                    <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <rect x="0" y="0" width="24" height="24" />
                                        <path d="M9.82829464,16.6565893 C7.02541569,15.7427556 5,13.1079084 5,10 C5,6.13400675 8.13400675,3 12,3 C15.8659932,3 19,6.13400675 19,10 C19,13.1079084 16.9745843,15.7427556 14.1717054,16.6565893 L12,21 L9.82829464,16.6565893 Z M12,12 C13.1045695,12 14,11.1045695 14,10 C14,8.8954305 13.1045695,8 12,8 C10.8954305,8 10,8.8954305 10,10 C10,11.1045695 10.8954305,12 12,12 Z" fill="#000000" />
                                    </g>
                                </svg><!--end::Svg Icon-->
                            </span>
                            <span class="fs-5 fw-normal text-gray-600">@order.LocationName</span>
                        </div>
                    </div>
                </div>
            </div>
        }
    }
    <div class="mt-10 mb-8">
        @{
            if (Model.MetaData.TotalPages > 1 && Model.MetaData.CurrentPage <= Model.MetaData.TotalPages)
            {
                <ul class="pagination pagination-outline">
                    @{
                        if (@Model.MetaData.HasPrevious)
                        {
                            <li class="page-item previous m-1">
                                <a asp-controller="orders" asp-action="Index" asp-route-page="@(Model.MetaData.CurrentPage-1)" class="page-link"><i class="previous"></i></a>
                            </li>
                        }
                        else
                        {
                            <li class="page-item previous disabled m-1">
                                <a href="#" class="page-link"><i class="previous"></i></a>
                            </li>
                        }
                        if (Model.MetaData.TotalPages > 12)
                        {
                            if (Model.MetaData.CurrentPage == 1)
                            {
                                <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="1" class="page-link">1</a></li>
                            }
                            else
                            {
                                <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="1" class="page-link">1</a></li>
                            }
                            if (Model.MetaData.CurrentPage == 2)
                            {
                                <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="2" class="page-link">2</a></li>
                            }
                            else
                            {
                                <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="2" class="page-link">2</a></li>
                            }
                            if (Model.MetaData.CurrentPage < 8)
                            {
                                for (int _page = 3; _page <= 10; _page++)
                                {

                                    if (_page == Model.MetaData.CurrentPage)
                                    {
                                        <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                    }
                                    else
                                    {
                                        <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                    }
                                }
                                <li class="page-item disabled"><a class="page-link">...</a></li>
                            }
                            else if (Model.MetaData.CurrentPage >= 8 && Model.MetaData.CurrentPage < Model.MetaData.TotalPages - 7)
                            {
                                <li class="page-item disabled"><a class="page-link">...</a></li>
                                for (int _page = Model.MetaData.CurrentPage - 3; _page <= Model.MetaData.CurrentPage + 3; _page++)
                                {
                                    if (_page == Model.MetaData.CurrentPage)
                                    {
                                        <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                    }
                                    else
                                    {
                                        <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                    }
                                }
                                <li class="page-item disabled"><a class="page-link">...</a></li>
                            }
                            else if (Model.MetaData.CurrentPage >= Model.MetaData.TotalPages - 7)
                            {
                                <li class="page-item disabled"><a class="page-link">...</a></li>
                                for (int _page = Model.MetaData.TotalPages - 9; _page <= Model.MetaData.TotalPages - 2; _page++)
                                {
                                    if (_page == Model.MetaData.CurrentPage)
                                    {
                                        <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                    }
                                    else
                                    {
                                        <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                    }
                                }
                            }
                            if (Model.MetaData.TotalPages - 1 == Model.MetaData.CurrentPage)
                            {
                                <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@(Model.MetaData.TotalPages - 1)" class="page-link">@(Model.MetaData.TotalPages - 1)</a></li>
                            }
                            else
                            {
                                <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@(Model.MetaData.TotalPages - 1)" class="page-link">@(Model.MetaData.TotalPages - 1)</a></li>
                            }
                            if (Model.MetaData.TotalPages == Model.MetaData.CurrentPage)
                            {
                                <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@Model.MetaData.TotalPages" class="page-link">@Model.MetaData.TotalPages</a></li>
                            }
                            else
                            {
                                <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@Model.MetaData.TotalPages" class="page-link">@Model.MetaData.TotalPages</a></li>
                            }
                        }
                        else
                        {
                            for (int _page = 1; _page <= Model.MetaData.TotalPages; _page++)
                            {

                                if (_page == Model.MetaData.CurrentPage)
                                {
                                    <li class="page-item active m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                }
                                else
                                {
                                    <li class="page-item m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@_page" class="page-link">@_page</a></li>
                                }
                            }
                        }
                        if (Model.MetaData.HasNext)
                        {
                            <li class="page-item next m-1"><a asp-controller="orders" asp-action="Index" asp-route-page="@(Model.MetaData.CurrentPage + 1)" class="page-link"><i class="next"></i></a></li>
                        }
                        else
                        {
                            <li class="page-item next disabled m-1"><a href="#" class="page-link"><i class="next"></i></a></li>
                        }
                    }
                </ul>
            }
        }
    </div>
</div>